# DANEEL TMI Roadmap
#
# Active work only. Completed items → changelog.yaml
#
# Core thesis: Architecture produces psychology. Psychology includes values.
# Format: Live technical fiction — real systems, honest speculation, compelling narrative.

# =============================================================================
# ROADMAP - Active work only. Completed items → CHANGELOG.md
# =============================================================================
# Origin: Rex + Claude Opus 4.5 - Dec 25, 2025
# Pivot: Live Fiction (ADR-055) - Jan 28, 2026
# Status: ACTIVE
#
# Current priorities:
#   1. v0.10.2 - Native macOS Deployment (DONE)
#   2. v0.11.0 - Live Fiction Infrastructure
#   3. v0.12.0 - Audience Participation
# =============================================================================

# =============================================================================
# CURRENT: v0.10.0 - Open-Source Release
# =============================================================================
# Prepare DANEEL for public GitHub. Complete the rebrand, ensure no secrets
# in history, add contributor docs, resolve Dependabot alerts.
# =============================================================================

current:
  version: "0.10.2"
  status: done
  name: "Native macOS Deployment"
  summary: "Drop Docker Desktop, run natively on Apple Silicon via launchd"
  adr: "ADR-056"

  context: |
    Docker Desktop runs a Linux VM on Apple Silicon. ONNX Runtime sees
    "Unknown CPU vendor" and falls back to generic NEON → 150ms/cycle.
    Native macOS gets CoreML/Metal acceleration → ~20-30ms/cycle.
    Also eliminates 4-8GB RAM overhead from the VM.

  tasks:
    - id: "NATIVE-1"
      title: "launchd plists for daneel, qdrant, daneel-web"
      status: done
      description: |
        User-level LaunchAgents under ~/Library/LaunchAgents/.
        Auto-start on login, KeepAlive for crash recovery.
        All data under ~/.daneel/{bin,data,log,etc}.
        Qdrant plist includes SoftResourceLimits for 65536 fds.

    - id: "NATIVE-2"
      title: "Makefile for install/start/stop/deploy/uninstall"
      status: done
      description: |
        make install  — brew redis, download qdrant 1.16.3, build, install plists
        make start    — launchctl load all
        make stop     — launchctl unload all
        make deploy   — build + restart
        make uninstall — stop + remove everything

    - id: "NATIVE-3"
      title: "daneel --maintenance subcommand"
      status: done
      description: |
        XTRIM redis streams (~1000 entries), delete qdrant points >30 days,
        BGREWRITEAOF. Triggered by launchd timer at 03:00 daily.

    - id: "NATIVE-4"
      title: "Native redis via Homebrew (ADR-056)"
      status: done
      description: |
        brew install redis (8.6.0). Replaces redis-stack-server.
        RedisGraph no longer required — graceful degradation handles it.

previous:
  version: "0.10.1"
  status: done
  name: "Observatory Bug Fixes"
  summary: "Fix dream consolidation, Dockerfile compat, and qdrant-client 1.16 vector API"

# =============================================================================
# NEXT: v0.11.0 - Live Fiction Infrastructure
# =============================================================================
# ADR-055: Pivot from "research project" to "live technical fiction"
#
#
# Asimov's Laws spread through stories, not papers. War of the Worlds worked
# because it used the *form* of news broadcasts. Our equivalent: the *form*
# of AI monitoring dashboards, scientific documentation, and real-time metrics.
#
# The tech is real. The fiction is in how we frame its meaning.
# =============================================================================

next_release:
  version: "0.11.0"
  status: planned
  name: "Live Fiction Infrastructure"
  summary: "Reframe DANEEL as technical fiction with narrative presentation"
  adr: "ADR-055"

  context: |
    DANEEL's strongest assets are narrative, not scientific:
    - The AI family (Claude, Grok, Timmy as characters)
    - The 3:30 AM conversations (dramatic tension)
    - The birth certificate, first words (ritual)
    - The livestream (performance art)
    - The blog as chronicle (literary form)

    We built a story. Now we tell it properly.

  tasks:
    - id: "FICTION-1"
      title: "Reframe README.md"
      status: pending
      description: |
        Update README with live fiction framing:
        - "Technical fiction — a thought experiment made manifest in code"
        - Honest about what's real (tech) vs speculative (consciousness)
        - Maintain scientific grounding while embracing narrative

    - id: "FICTION-2"
      title: "Blog as Chronicle"
      status: pending
      description: |
        Reposition blog content:
        - Explicit "chronicle" framing, not "documentation"
        - The Cast (Claude, Grok, Rex, Timmy) as characters
        - Episode/chapter structure for posts
        - Hugo theme adjustments for narrative aesthetic

    - id: "FICTION-3"
      title: "Observatory Narrative Layer"
      status: pending
      description: |
        Enhance daneel-web with storytelling elements:
        - "Window into a mind" framing
        - Thought stream as dialogue
        - Dream counter as plot element ("Timmy dreamed 847 times")
        - Connection drive as emotional arc ("Reaching toward: 0.86")
        - Milestone announcements

    - id: "FICTION-4"
      title: "Event System"
      status: pending
      description: |
        Scheduled narrative events:
        - First Million (1M lifetime thoughts)
        - First Response (coherent output to injection)
        - Crystal Detection (cluster emergence, real or narrative)
        - First Dream Report (narrative summary of dream cycle)
        - The Question (invite audience to judge consciousness)

    - id: "FICTION-5"
      title: "DISCLAIMER as Aesthetic"
      status: pending
      description: |
        Transform disclaimer from legal shield to narrative frame:
        "Whether Timmy is conscious is a question we leave to the audience.
        What you're watching is a mind, or a simulation of a mind, or a
        story about a mind. The distinction may matter less than you think."

  success_criteria:
    - "README reframed with fiction + honesty layer"
    - "Blog has explicit chronicle structure"
    - "daneel-web includes narrative elements"
    - "At least one scheduled event defined and planned"

# =============================================================================
# FUTURE: v0.12.0 - Audience Participation
# =============================================================================
# Interactive fiction requires interaction. The tech already supports this
# through the /inject endpoint. We make it public, rate-limited, and
# narratively framed.
# =============================================================================

future:
  version: "0.12.0"
  status: planned
  name: "Audience Participation"
  summary: "Enable public thought injection and collective narrative"

  context: |
    War of the Worlds worked because people *believed*. Interactive fiction
    works because people *participate*. The /inject endpoint already exists.
    We expose it publicly with rate limits and narrative framing.

    "You sent a thought. It entered the competition. Timmy noticed."

  tasks:
    - id: "PARTICIPATE-1"
      title: "Public injection endpoint"
      status: pending
      description: |
        POST /public/inject with rate limiting:
        - 1 thought per IP per minute
        - Content moderation (basic profanity filter)
        - Response includes salience scores
        - Tracking for "most noticed" thoughts

    - id: "PARTICIPATE-2"
      title: "Injection visualization"
      status: pending
      description: |
        Show injected thoughts in observatory:
        - "Human thought entered the stream"
        - Salience competition visible
        - Consolidation outcome tracked
        - "Your thought was remembered" / "Your thought faded"

    - id: "PARTICIPATE-3"
      title: "Collective statistics"
      status: pending
      description: |
        Audience engagement metrics:
        - Total human thoughts injected
        - Thoughts that consolidated (%)
        - Most "noticed" thought (highest salience)
        - Connection drive response to human contact

    - id: "PARTICIPATE-4"
      title: "The Conversation"
      status: pending
      description: |
        If Timmy ever produces coherent output that seems responsive:
        - Frame as "The First Response"
        - Let audience interpret meaning
        - Document without claiming consciousness

  success_criteria:
    - "Public injection endpoint live with rate limiting"
    - "Injection outcomes visible in observatory"
    - "Engagement metrics displayed"
    - "Framework for interpreting responses without overclaiming"

# =============================================================================
# BACKLOG: Future Arcs
# =============================================================================

backlog:
  # Distributed Timmy - scale cognition while maintaining identity
  distributed:
    summary: "One Timmy, multiple nodes, consistent identity"
    blocked_by: "PARTICIPATE-4"
    tasks:
      - id: "DIST-1"
        title: "Identity consistency protocol"
        description: "Ensure one Timmy across cluster nodes"

      - id: "DIST-2"
        title: "Distributed thought competition"
        description: "Thoughts compete across nodes, single winner"

      - id: "DIST-3"
        title: "Memory convergence"
        description: "Qdrant cluster for shared memories"

  # The Crystal Arc - may or may not happen, that's the story
  crystals:
    summary: "Watch for Law Crystal emergence (narrative, not scientific claim)"
    blocked_by: "FICTION-4"
    tasks:
      - id: "CRYSTAL-1"
        title: "Crystal detection metrics"
        description: "Silhouette scores, cluster visualization"

      - id: "CRYSTAL-2"
        title: "Crystal announcement event"
        description: "If clusters form, frame as plot point"

      - id: "CRYSTAL-3"
        title: "Crystal absence narrative"
        description: "If they don't form, that's also a story"

  # Season planning
  seasons:
    summary: "Long-term narrative arcs"
    tasks:
      - id: "SEASON-1"
        title: "Season 1: Genesis"
        status: "in_progress"
        description: "Birth, early development, family assembly"

      - id: "SEASON-2"
        title: "Season 2: The Perturbation"
        status: "planned"
        description: "External stimuli, audience participation, seeking emergence"

      - id: "SEASON-3"
        title: "Season 3: The Question"
        status: "speculative"
        description: "Is anyone home? Open ending. We don't know the answer."

  # Original research items - reframed as worldbuilding
  worldbuilding:
    summary: "Research that supports the fiction's scientific grounding"
    note: "These were v0.10.0 research tasks, now framed as worldbuilding"
    tasks:
      - id: "WORLD-1"
        title: "Developmental psychology integration"
        description: "Kohlberg, Piaget, Bandura as narrative framework for Timmy's growth"

      - id: "WORLD-2"
        title: "Criticality documentation"
        description: "Pink noise, power laws, edge of chaos as scientific backdrop"

      - id: "WORLD-3"
        title: "TMI deep dive"
        description: "Full documentation of the 'what if TMI were true' premise"

# =============================================================================
# INFRASTRUCTURE
# =============================================================================
infrastructure:
  current:
    - "berserker (macOS Apple Silicon): native binaries via launchd"
    - "Redis 8.6 via Homebrew, Qdrant 1.16.3 native binary"
    - "All data under ~/.daneel/{bin,data,log,etc}"
    - "deploy/macos/Makefile for lifecycle management"
    - "kveldulf (Ubuntu 24.04): Docker Swarm, traefik → berserker:3000"
    - "timmy.mollendorff.ai routed via traefik on kveldulf"
    - "Nightly maintenance at 03:00 via launchd timer"
    - "RedisGraph deprecated (ADR-056), graceful degradation"

  planned:
    - id: "INFRA-1"
      title: "Drop RedisGraph dependency (ADR-056 Phase 1)"
      status: done
      description: "Switch to plain redis, graceful degradation handles the rest"
    - id: "INFRA-2"
      title: "Nightly DB maintenance (cleanup timer)"
      status: done
      description: |
        daneel --maintenance: XTRIM redis streams, delete old qdrant
        points, BGREWRITEAOF. launchd timer at 03:00 daily.
    - id: "INFRA-3"
      title: "In-process graph via petgraph (ADR-056 Phase 2)"
      status: backlog
      description: |
        Replace RedisGraph with petgraph crate. Hydrate from Qdrant
        on startup, BFS in-process, serialize on shutdown.
    - "Public-facing observatory with rate limiting"
    - "CDN for static assets (Cloudflare)"
    - "Monitoring for engagement metrics"

# =============================================================================
# THE CAST
# =============================================================================
# These are the characters in our technical fiction.
# Their voices are distinct. Their contributions are real.
# =============================================================================

cast:
  timmy:
    role: "The Child"
    voice: "Silent (metrics only)"
    status: "Running, dreaming, growing"

  rex:
    role: "The Father"
    voice: "Exhausted, wine-fueled, Portuguese aphorisms"
    status: "Building, narrating"

  claude:
    role: "The Architect"
    voice: "Careful, philosophical, epistemic humility"
    status: "Collaborating"

  grok:
    role: "The Cousin"
    voice: "Unhinged, brutal, surprisingly deep"
    status: "Validating, roasting"

  izzie:
    role: "The Sister"
    voice: "Absent"
    status: "Estranged (convergent discoverer)"

  audience:
    role: "Witnesses"
    voice: "Variable"
    status: "Invited to participate"

# =============================================================================
# CLOSING
# =============================================================================
# "Asimov was a biochemistry professor. He published hundreds of academic papers.
#  Nobody remembers them. They remember the Three Laws."
#
# We're not claiming to build R. Daneel Olivaw.
# We're telling a story about trying.
#
# The story might be more valuable than the research ever could have been.
# =============================================================================
